class n{constructor(){this.logs=[],this.retentionDays=365,console.log("[AuditLog] System initialized")}log(t){const e={id:this.generateId(),timestamp:new Date,hash:"",...t};e.hash=this.calculateHash(e),this.logs.push(e),console.log(`[AuditLog] ${e.action} on ${e.resource} by ${e.userId}`)}query(t){return this.logs.filter(e=>!(t.userId&&e.userId!==t.userId||t.action&&e.action!==t.action||t.startDate&&e.timestamp<t.startDate||t.endDate&&e.timestamp>t.endDate||t.severity&&e.severity!==t.severity))}generateComplianceReport(t,e){const r=this.query({startDate:t,endDate:e}),s={},a={};for(const i of r)s[i.action]=(s[i.action]||0)+1,a[i.userId]=(a[i.userId]||0)+1;return{period:{start:t,end:e},totalLogs:r.length,actionBreakdown:s,userActivity:a,securityEvents:r.filter(i=>i.severity==="high"||i.severity==="critical").length,complianceViolations:r.filter(i=>i.result==="failure"&&i.severity==="critical")}}verifyIntegrity(){const t=[];for(const e of this.logs){const r=this.calculateHash({...e,hash:""});e.hash!==r&&t.push(e.id)}return{valid:t.length===0,tamperedEntries:t}}export(t){if(t==="json")return JSON.stringify(this.logs,null,2);const e=["ID","Timestamp","User","Action","Resource","Result","Severity"],r=this.logs.map(s=>[s.id,s.timestamp.toISOString(),s.userId,s.action,s.resource,s.result,s.severity]);return[e,...r].map(s=>s.join(",")).join(`
`)}calculateHash(t){const e=JSON.stringify({timestamp:t.timestamp,userId:t.userId,action:t.action,resource:t.resource});let r=0;for(let s=0;s<e.length;s++)r=(r<<5)-r+e.charCodeAt(s),r|=0;return r.toString(16)}generateId(){return`audit-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}cleanup(){const t=new Date;t.setDate(t.getDate()-this.retentionDays),this.logs=this.logs.filter(e=>e.timestamp>t)}}function c(){return new n}export{n as AuditLogSystem,c as getAuditLogSystem};
//# sourceMappingURL=AuditLogSystem-6Gf0P1u1.js.map
